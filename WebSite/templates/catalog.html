<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Каталог - Digital Gallery</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        button {
         width: 50;
         padding: 10px;
         border: none;
         border-radius: 5px;
         background: #bbb;
         color: #2e2e2e;
         font-weight: bold;
         cursor: pointer;
         transition: background 0.3s;
        }
        button:hover {
         background: #999;
        }
        /* Контейнер чекбокса */
        .checkbox-container {
          display: flex;
          align-items: left;
          margin-bottom: 3px;
          cursor: default;
        }

        /* Сам чекбокс */
        .checkbox-container input[type="checkbox"] {
          appearance: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          width: 25px;
          height: 25px;
          border: 2px solid #2e2e2e;
          border-radius: 4px;
          margin-right: 10px;
          position: relative;
          outline: none;
          cursor: pointer;
          transition: background-color 0.2s, border-color 0.2s;
        }

        /* Стили при активации чекбокса */
        .checkbox-container input[type="checkbox"]:checked {
          background: linear-gradient(135deg, #bbb, #999999);
        }

        /* Текст рядом с чекбоксом */
        .checkbox-container label {
          cursor: pointer;
          color: #cccccc;
          font-size: 1rem;
        }
    </style>
</head>
<body>
<!-- Меню -->
{% include 'header.html' %}

<!-- Форма фильтрации -->
<form id="filterForm" method="get" action="{{ url_for('catalog') }}">
    <section class="reveal" id="filterSection">
        <h2>Фильтрация произведений</h2>
        <div class="filter-group">
            <label for="titleInput">По названию:</label>
            <input list="titles" id="titleInput" name="title" value="{{ title if title else '' }}">
            <datalist id="titles">
                {% for t in titles %}
                <option value="{{ t }}">
                    {% endfor %}
            </datalist>

            <label for="authorInput">По автору:</label>
            <input list="authors" id="authorInput" name="author" value="{{ author if author else '' }}">
            <datalist id="authors">
                {% for a in authors %}
                <option value="{{ a }}">
                    {% endfor %}
            </datalist>

            <label for="categoryInput">По категории:</label>
            <input list="categories" id="categoryInput" name="category" value="{{ category if category else '' }}">
            <datalist id="categories">
                {% for c in categories %}
                <option value="{{ c }}">
                    {% endfor %}
            </datalist>
            <div class="checkbox-container">
                <input type="checkbox" id="top_filter" name="top_filter" value="on"
                       {% if top_filter %}checked{% endif %}>
                <label for="top_filter">Сначала популярные</label>
            </div>
        </div>
    </section>
</form>

<!-- Секция с произведениями -->
<section class="reveal" id="worksSection">
    <h2>Произведения</h2>
    <div class="works-grid">
        {% for work in works %}
        <div class="work-card">
            <a href="{{ url_for('artwork', id=work.id) }}">
                <img src="{{ url_for('static', filename='img/' ~ work.id ~ work.extension) }}">
            </a>
            <div class="info">
                <h3>{{work.name}}</h3>
                <p>Автор: {{work.creator_user.nick_name}}</p>
                <p>Цена: {{work.price}} coins</p>
                <p>Описание: {{work.short_description}}.</p>
            </div>
        </div>
        {% endfor %}
    </div>
</section>


<script>
    window.addEventListener("load", () => {
      const reveals = document.querySelectorAll(".reveal");
      reveals.forEach(el => {
        el.classList.add("active");
      });
    });
    // Реагирование на чекбокс
    const checkbox = document.getElementById("top_filter");
    const form = document.getElementById("filterForm");

    checkbox.addEventListener("change", () => {
        form.submit();
    });

    // Реагирование на нажатие Enter
    const inputs = ['titleInput', 'authorInput', 'categoryInput'];

    inputs.forEach(id => {
        const el = document.getElementById(id);
        el.addEventListener('keydown', function (e) {
          if (e.key === 'Enter') {
            e.preventDefault();
            form.submit();
          }
        });
    });
</script>
</body>
</html>
